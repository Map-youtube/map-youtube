<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>여행지 및 식당 안내</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAjMNd7u5X5jetqbFXJEr-hF-Ku8_oReGI&libraries=places&callback=initMap" async defer></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #map {
            height: 600px; /* 기본 높이 */
            width: 100%; /* 모바일 환경에서 100%로 채움 */
        }
        .info-box {
            position: absolute;
            bottom: 10px; /* 기본 위치 */
            left: 10px;
            width: calc(100% - 20px); /* 모바일 환경에서 기본 너비 */
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: none; /* 그림자 효과 제거 */
            display: none; /* 초기에는 숨김 */
        }
        #youtubeEmbed {
            width: 100%;
            position: relative;
            padding-bottom: 56.25%; /* 16:9 비율을 유지하기 위한 비율 */
            height: 0;
            overflow: hidden;
        }
        #youtubeEmbed iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%; /* 전체 화면이 보이도록 설정 */
        }

        /* 모바일 환경 스타일 */
        @media (max-width: 768px) {
            #map {
                height: 300px; /* 모바일에서 지도 높이 조정 */
            }
            .info-box {
                bottom: 5px; /* 모바일에서 안내창 위치 조정 */
            }
        }
        /* PC 환경에서 화면 비율 조정 */
        @media (min-width: 769px) {
            #map {
                width: 60%; /* PC 환경에서 지도는 60% */
                height: 600px; /* 고정 높이 */
                float: left; /* 지도 왼쪽 배치 */
            }
            .info-box {
                position: static; /* 절대 위치 해제 */
                width: 40%; /* 안내창을 40%로 설정 */
                float: left; /* 안내창을 지도 오른쪽에 배치 */
                height: 600px; /* 지도와 같은 높이로 맞춤 */
                overflow-y: auto; /* 내용이 넘칠 경우 스크롤 */
                box-sizing: border-box; /* 패딩과 폭을 제대로 계산 */
            }
        }

        /* 검색창 위치 스타일 */
        .pac-container {
            z-index: 1000;
        }
        #searchInput {
            position: absolute;
            top: 10px;  /* "지도, 위성" 버튼 아래 위치 */
            left: 10px;
            width: 250px;
            z-index: 5; /* 맵 위에 나타나도록 함 */
            padding: 10px;
        }
    </style>
</head>
<body>

    <h1>여행지 및 식당 안내</h1>
    <input id="searchInput" type="text" placeholder="검색어 입력">
    <div id="map"></div>
    <div class="info-box" id="infoBox">
        <h3 id="storeName"></h3>
        <p>가게주소 : <span id="storeAddress"></span></p>
        <p>영업시간 : <span id="storeHours"></span></p>
        <p>YouTube Link : <a href="#" id="youtubeLink" target="_blank">링크 보기</a></p>
        <div id="youtubeEmbed" style="display:none;">
            <iframe src="" frameborder="0" allowfullscreen></iframe>
        </div>
    </div>

    <script>
        let map;

        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 12.7882166, lng: 101.135258 },
                zoom: 10,
            });

            const locations = [
                { title: "맛잇다식당", address: "서울군", hours: "1시간", lat: 12.7874027, lng: 101.135227, videoId: "gCWIa4TwcPc" }
                // 더 많은 위치를 추가할 수 있음
            ];

            locations.forEach(location => {
                const marker = new google.maps.Marker({
                    position: { lat: location.lat, lng: location.lng },
                    map: map, // 마커 초기화 시 지도에 표시
                    title: location.title,
                });

                // 마커 클릭 시 안내창에 정보 표시
                marker.addListener("click", () => {
                    showInfoBox(location);
                    map.panTo(marker.getPosition());
                });
            });

            // 검색창 추가 (Autocomplete)
            const input = document.getElementById("searchInput");
            const autocomplete = new google.maps.places.Autocomplete(input);
            autocomplete.bindTo('bounds', map);

            autocomplete.addListener('place_changed', () => {
                const place = autocomplete.getPlace();

                if (!place.geometry || !place.geometry.location) {
                    alert("검색 결과가 없습니다.");
                    return;
                }

                // 검색한 위치로 지도 이동
                if (place.geometry.viewport) {
                    map.fitBounds(place.geometry.viewport);
                } else {
                    map.setCenter(place.geometry.location);
                    map.setZoom(16);
                }

                // 검색 결과에 따른 정보창 출력
                showInfoBox({
                    title: place.name,
                    address: place.formatted_address || "정보 없음",
                    hours: place.opening_hours ? (place.opening_hours.open_now ? "영업 중" : "영업 종료") : "영업시간 정보 없음",
                    videoId: "" // 검색 결과에 대한 YouTube 영상은 없을 수 있음
                });
            });

            document.getElementById("youtubeLink").addEventListener("click", function(event) {
                event.preventDefault(); // 기본 링크 동작 방지
                const videoId = locations[0].videoId;
                const videoLink = `https://www.youtube.com/embed/${videoId}`;
                
                if (window.innerWidth <= 768) {
                    // 모바일 환경에서 자동 스크롤 및 영상 표시
                    document.getElementById("youtubeEmbed").style.display = 'block';
                    document.querySelector("#youtubeEmbed iframe").src = videoLink;
                    window.scrollTo(0, document.body.scrollHeight); // 페이지 아래로 스크롤
                } else {
                    // PC 환경에서 영상 표시
                    document.getElementById("youtubeEmbed").style.display = 'block';
                    document.querySelector("#youtubeEmbed iframe").src = videoLink;
                }
            });
        }

        function showInfoBox(location) {
            document.getElementById("storeName").innerText = location.title;
            document.getElementById("storeAddress").innerText = location.address;
            document.getElementById("storeHours").innerText = location.hours;
            document.getElementById("youtubeLink").href = `https://www.youtube.com/watch?v=${location.videoId}`;
            document.getElementById("infoBox").style.display = "block";
            document.getElementById("youtubeEmbed").style.display = "none"; // 초기에는 유튜브 숨김
        }
    </script>
</body>
</html>
