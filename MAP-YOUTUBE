<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>여행지 및 식당 안내</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAjMNd7u5X5jetqbFXJEr-hF-Ku8_oReGI&libraries=places&callback=initMap" async defer></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #map {
            height: 600px; 
            width: 100%; 
        }
        .info-box {
            position: absolute;
            bottom: 10px; 
            left: 10px;
            width: calc(100% - 20px); 
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: none; 
            display: none; 
        }
        #youtubeEmbed {
            width: 100%;
            position: relative;
            padding-bottom: 56.25%; 
            height: 0;
            overflow: hidden;
        }
        #youtubeEmbed iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%; 
        }

        @media (max-width: 768px) {
            #map {
                height: 300px; 
            }
            .info-box {
                bottom: 5px; 
            }
        }

        @media (min-width: 769px) {
            #map {
                width: 60%; 
                height: 600px; 
                float: left; 
            }
            .info-box {
                position: static; 
                width: 40%; 
                float: left; 
                height: 600px; 
                overflow-y: auto; 
                box-sizing: border-box;
            }
        }

        .pac-container {
            z-index: 1000;
        }
        #searchInput {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 250px;
            z-index: 5; 
            padding: 10px;
        }
    </style>
</head>
<body>

    <h1>여행지 및 식당 안내</h1>
    <input id="searchInput" type="text" placeholder="검색어 입력">
    <div id="map"></div>
    <div class="info-box" id="infoBox">
        <h3 id="storeName"></h3>
        <p>가게주소 : <span id="storeAddress"></span></p>
        <p>영업시간 : <span id="storeHours"></span></p>
        <p>YouTube Link : <a href="#" id="youtubeLink" target="_blank">링크 보기</a></p>
        <div id="youtubeEmbed" style="display:none;">
            <iframe src="" frameborder="0" allowfullscreen></iframe>
        </div>
    </div>

    <script>
        let map;

        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 12.7882166, lng: 101.135258 },
                zoom: 10,
            });

            const locations = [
                { title: "맛잇다식당", address: "서울군", hours: "1시간", lat: 12.7874027, lng: 101.135227, videoId: "gCWIa4TwcPc" }
                // 더 많은 위치를 추가할 수 있음
            ];

            // 각 위치에 대해 마커 추가
            locations.forEach(location => {
                const marker = new google.maps.Marker({
                    position: { lat: location.lat, lng: location.lng },
                    map: map,
                    title: location.title,
                });

                // 마커 클릭 시 안내창에 정보 표시
                marker.addListener("click", () => {
                    showInfoBox(location);
                    map.panTo(marker.getPosition());
                });
            });

            // 검색창 (Autocomplete)
            const input = document.getElementById("searchInput");
            const autocomplete = new google.maps.places.Autocomplete(input);
            autocomplete.bindTo('bounds', map);

            autocomplete.addListener('place_changed', () => {
                const place = autocomplete.getPlace();

                if (!place.geometry || !place.geometry.location) {
                    alert("검색 결과가 없습니다.");
                    return;
                }

                // 검색한 위치로 지도 이동
                if (place.geometry.viewport) {
                    map.fitBounds(place.geometry.viewport);
                } else {
                    map.setCenter(place.geometry.location);
                    map.setZoom(16);
                }

                // 검색 결과에 따른 정보창 출력
                showInfoBox({
                    title: place.name,
                    address: place.formatted_address || "정보 없음",
                    hours: place.opening_hours ? (place.opening_hours.open_now ? "영업 중" : "영업 종료") : "영업시간 정보 없음",
                    videoId: "" 
                });
            });
        }

        function showInfoBox(location) {
            document.getElementById("storeName").innerText = location.title;
            document.getElementById("storeAddress").innerText = location.address;
            document.getElementById("storeHours").innerText = location.hours;
            document.getElementById("youtubeLink").href = `https://www.youtube.com/watch?v=${location.videoId}`;
            document.getElementById("infoBox").style.display = "block";
            document.getElementById("youtubeEmbed").style.display = "none"; 
        }
    </script>
</body>
</html>
